/*! cputils.js (C) 2013-present SheetJS -- http://sheetjs.com */,function(t,n){"use strict";if("undefined"===typeof r){var a=r;e.exports&&"undefined"===typeof DO_NOT_EXPORT_CODEPAGE?e.exports=n(a):t.cptable=n(a)}else r=n(r)}(this,(function(e){"use strict";var r={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},n=[874,1250,1251,1252,1253,1254,1255,1256,1e4],a=[932,936,949,950],i=[65001],s={},o={},d={},l={},c=function(e){return String.fromCharCode(e)},f=function(e){return e.charCodeAt(0)},h="undefined"!==typeof t,u=function(){};if(h){var p=!t.from;if(!p)try{t.from("foo","utf8")}catch(P){p=!0}u=p?function(e,r){return r?new t(e,r):new t(e)}:t.from.bind(t),t.allocUnsafe||(t.allocUnsafe=function(e){return new t(e)});var g=1024,m=t.allocUnsafe(g),b=function(e){for(var r=t.allocUnsafe(65536),n=0;n<65536;++n)r[n]=0;for(var a=Object.keys(e),i=a.length,s=0,o=a[s];s<i;++s)(o=a[s])&&(r[o.charCodeAt(0)]=e[o]);return r},v=function(r){var n=b(e[r].enc);return function(e,r){var a,i=e.length,s=0,o=0,d=0,l=0;if("string"===typeof e)for(a=t.allocUnsafe(i),s=0;s<i;++s)a[s]=n[e.charCodeAt(s)];else if(t.isBuffer(e)){for(a=t.allocUnsafe(2*i),o=0,s=0;s<i;++s)d=e[s],d<128?a[o++]=n[d]:d<224?(a[o++]=n[((31&d)<<6)+(63&e[s+1])],++s):d<240?(a[o++]=n[((15&d)<<12)+((63&e[s+1])<<6)+(63&e[s+2])],s+=2):(l=((7&d)<<18)+((63&e[s+1])<<12)+((63&e[s+2])<<6)+(63&e[s+3]),s+=3,l<65536?a[o++]=n[l]:(l-=65536,a[o++]=n[55296+(l>>10&1023)],a[o++]=n[56320+(1023&l)]));a=a.slice(0,o)}else for(a=t.allocUnsafe(i),s=0;s<i;++s)a[s]=n[e[s].charCodeAt(0)];return r&&"buf"!==r?"arr"!==r?a.toString("binary"):[].slice.call(a):a}},w=function(r){var n=e[r].dec,a=t.allocUnsafe(131072),i=0,s="";for(i=0;i<n.length;++i)if(s=n[i]){var o=s.charCodeAt(0);a[2*i]=255&o,a[2*i+1]=o>>8}return function(e){var r=e.length,n=0,i=0;if(2*r>g&&(g=2*r,m=t.allocUnsafe(g)),t.isBuffer(e))for(n=0;n<r;n++)i=2*e[n],m[2*n]=a[i],m[2*n+1]=a[i+1];else if("string"===typeof e)for(n=0;n<r;n++)i=2*e.charCodeAt(n),m[2*n]=a[i],m[2*n+1]=a[i+1];else for(n=0;n<r;n++)i=2*e[n],m[2*n]=a[i],m[2*n+1]=a[i+1];return m.slice(0,2*r).toString("ucs2")}},$=function(r){for(var n=e[r].enc,a=t.allocUnsafe(131072),i=0;i<131072;++i)a[i]=0;for(var s=Object.keys(n),o=0,d=s[o];o<s.length;++o)if(d=s[o]){var l=d.charCodeAt(0);a[2*l]=255&n[d],a[2*l+1]=n[d]>>8}return function(e,r){var n=e.length,i=t.allocUnsafe(2*n),s=0,o=0,d=0,l=0,c=0;if("string"===typeof e){for(s=l=0;s<n;++s)o=2*e.charCodeAt(s),i[l++]=a[o+1]||a[o],a[o+1]>0&&(i[l++]=a[o]);i=i.slice(0,l)}else if(t.isBuffer(e)){for(s=l=0;s<n;++s)c=e[s],c<128?o=c:c<224?(o=((31&c)<<6)+(63&e[s+1]),++s):c<240?(o=((15&c)<<12)+((63&e[s+1])<<6)+(63&e[s+2]),s+=2):(o=((7&c)<<18)+((63&e[s+1])<<12)+((63&e[s+2])<<6)+(63&e[s+3]),s+=3),o<65536?(o*=2,i[l++]=a[o+1]||a[o],a[o+1]>0&&(i[l++]=a[o])):(d=o-65536,o=2*(55296+(d>>10&1023)),i[l++]=a[o+1]||a[o],a[o+1]>0&&(i[l++]=a[o]),o=2*(56320+(1023&d)),i[l++]=a[o+1]||a[o],a[o+1]>0&&(i[l++]=a[o]));i=i.slice(0,l)}else for(s=l=0;s<n;s++)o=2*e[s].charCodeAt(0),i[l++]=a[o+1]||a[o],a[o+1]>0&&(i[l++]=a[o]);return r&&"buf"!==r?"arr"!==r?i.toString("binary"):[].slice.call(i):i}},E=function(r){var n,a=e[r].dec,i=t.allocUnsafe(131072),s=0,o=0,d=0,l=0;for(l=0;l<65536;++l)i[2*l]=255,i[2*l+1]=253;for(s=0;s<a.length;++s)(n=a[s])&&(o=n.charCodeAt(0),d=2*s,i[d]=255&o,i[d+1]=o>>8);return function(e){var r=e.length,n=t.allocUnsafe(2*r),a=0,s=0,o=0;if(t.isBuffer(e))for(a=0;a<r;a++)s=2*e[a],255===i[s]&&253===i[s+1]&&(s=2*((e[a]<<8)+e[a+1]),++a),n[o++]=i[s],n[o++]=i[s+1];else if("string"===typeof e)for(a=0;a<r;a++)s=2*e.charCodeAt(a),255===i[s]&&253===i[s+1]&&(s=2*((e.charCodeAt(a)<<8)+e.charCodeAt(a+1)),++a),n[o++]=i[s],n[o++]=i[s+1];else for(a=0;a<r;a++)s=2*e[a],255===i[s]&&253===i[s+1]&&(s=2*((e[a]<<8)+e[a+1]),++a),n[o++]=i[s],n[o++]=i[s+1];return n.slice(0,o).toString("ucs2")}};s[65001]=function e(r){if("string"===typeof r)return e(r.split("").map(f));var n=r.length,a=0,i=0;4*n>g&&(g=4*n,m=t.allocUnsafe(g));var s=0;n>=3&&239==r[0]&&187==r[1]&&191==r[2]&&(s=3);for(var o=1,d=0,l=0;s<n;s+=o)o=1,l=r[s],l<128?a=l:l<224?(a=64*(31&l)+(63&r[s+1]),o=2):l<240?(a=((15&l)<<12)+64*(63&r[s+1])+(63&r[s+2]),o=3):(a=262144*(7&l)+((63&r[s+1])<<12)+64*(63&r[s+2])+(63&r[s+3]),o=4),a<65536?(m[d++]=255&a,m[d++]=a>>8):(a-=65536,i=55296+(a>>10&1023),a=56320+(1023&a),m[d++]=255&i,m[d++]=i>>>8,m[d++]=255&a,m[d++]=a>>>8&255);return m.slice(0,d).toString("ucs2")},o[65001]=function(e,r){if(h&&t.isBuffer(e))return r&&"buf"!==r?"arr"!==r?e.toString("binary"):[].slice.call(e):e;var n=e.length,a=0,i=0,s=0,o="string"===typeof e;4*n>g&&(g=4*n,m=t.allocUnsafe(g));for(var d=0;d<n;++d)a=o?e.charCodeAt(d):e[d].charCodeAt(0),a<=127?m[s++]=a:a<=2047?(m[s++]=192+(a>>6),m[s++]=128+(63&a)):a>=55296&&a<=57343?(a-=55296,++d,i=(o?e.charCodeAt(d):e[d].charCodeAt(0))-56320+(a<<10),m[s++]=240+(i>>>18&7),m[s++]=144+(i>>>12&63),m[s++]=128+(i>>>6&63),m[s++]=128+(63&i)):(m[s++]=224+(a>>12),m[s++]=128+(a>>6&63),m[s++]=128+(63&a));return r&&"buf"!==r?"arr"!==r?m.slice(0,s).toString("binary"):[].slice.call(m,0,s):m.slice(0,s)}}var C=function(){if(h){if(d[n[0]])return;var t=0,r=0;for(t=0;t<n.length;++t)r=n[t],e[r]&&(d[r]=w(r),l[r]=v(r));for(t=0;t<a.length;++t)r=a[t],e[r]&&(d[r]=E(r),l[r]=$(r));for(t=0;t<i.length;++t)r=i[t],s[r]&&(d[r]=s[r]),o[r]&&(l[r]=o[r])}},S=function(e,t){return""},y=function(e){delete d[e],delete l[e]},k=function(){if(h){if(!d[n[0]])return;n.forEach(y),a.forEach(y),i.forEach(y)}T=S,x=0},A={encache:C,decache:k,sbcs:n,dbcs:a};C();var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",T=S,x=0,I=function n(a,i,s){if(a===x&&T)return T(i,s);if(l[a])return T=l[x=a],T(i,s);h&&t.isBuffer(i)&&(i=i.toString("utf8"));var o,d=i.length,f=h?t.allocUnsafe(4*d):[],p=0,g=0,m=0,b=0,v=e[a],w="",$="string"===typeof i;if(v&&(o=v.enc))for(g=0;g<d;++g,++m)p=o[$?i.charAt(g):i[g]],p>255?(f[m]=p>>8,f[++m]=255&p):f[m]=255&p;else{if(!(w=r[a]))throw new Error("Unrecognized CP: "+a);switch(w){case"utf8":if(h&&$){f=u(i,w),m=f.length;break}for(g=0;g<d;++g,++m)p=$?i.charCodeAt(g):i[g].charCodeAt(0),p<=127?f[m]=p:p<=2047?(f[m]=192+(p>>6),f[++m]=128+(63&p)):p>=55296&&p<=57343?(p-=55296,b=($?i.charCodeAt(++g):i[++g].charCodeAt(0))-56320+(p<<10),f[m]=240+(b>>>18&7),f[++m]=144+(b>>>12&63),f[++m]=128+(b>>>6&63),f[++m]=128+(63&b)):(f[m]=224+(p>>12),f[++m]=128+(p>>6&63),f[++m]=128+(63&p));break;case"ascii":if(h&&"string"===typeof i){f=u(i,w),m=f.length;break}for(g=0;g<d;++g,++m){if(p=$?i.charCodeAt(g):i[g].charCodeAt(0),!(p<=127))throw new Error("bad ascii "+p);f[m]=p}break;case"utf16le":if(h&&"string"===typeof i){f=u(i,w),m=f.length;break}for(g=0;g<d;++g)p=$?i.charCodeAt(g):i[g].charCodeAt(0),f[m++]=255&p,f[m++]=p>>8;break;case"utf16be":for(g=0;g<d;++g)p=$?i.charCodeAt(g):i[g].charCodeAt(0),f[m++]=p>>8,f[m++]=255&p;break;case"utf32le":for(g=0;g<d;++g)p=$?i.charCodeAt(g):i[g].charCodeAt(0),p>=55296&&p<=57343&&(p=65536+(p-55296<<10)+(i[++g].charCodeAt(0)-56320)),f[m++]=255&p,p>>=8,f[m++]=255&p,p>>=8,f[m++]=255&p,p>>=8,f[m++]=255&p;break;case"utf32be":for(g=0;g<d;++g)p=$?i.charCodeAt(g):i[g].charCodeAt(0),p>=55296&&p<=57343&&(p=65536+(p-55296<<10)+(i[++g].charCodeAt(0)-56320)),f[m+3]=255&p,p>>=8,f[m+2]=255&p,p>>=8,f[m+1]=255&p,p>>=8,f[m]=255&p,m+=4;break;case"utf7":for(g=0;g<d;g++){var E=$?i.charAt(g):i[g].charAt(0);if("+"!==E)if(B.indexOf(E)>-1)f[m++]=E.charCodeAt(0);else{var C=n(1201,E);f[m++]=43,f[m++]=_.charCodeAt(C[0]>>2),f[m++]=_.charCodeAt(((3&C[0])<<4)+((C[1]||0)>>4)),f[m++]=_.charCodeAt(((15&C[1])<<2)+((C[2]||0)>>6)),f[m++]=45}else f[m++]=43,f[m++]=45}break;default:throw new Error("Unsupported magic: "+a+" "+r[a])}}return f=f.slice(0,m),h?s&&"buf"!==s?"arr"!==s?f.toString("binary"):[].slice.call(f):f:"str"==s?f.map(c).join(""):f},R=function n(a,i){var s;if(s=d[a])return s(i);if("string"===typeof i)return n(a,i.split("").map(f));var o,l=i.length,c=new Array(l),u="",p=0,g=0,m=1,b=0,v=0,w=e[a],$="";if(w&&(o=w.dec))for(g=0;g<l;g+=m){if(m=2,u=o[(i[g]<<8)+i[g+1]],u||(m=1,u=o[i[g]]),!u)throw new Error("Unrecognized code: "+i[g]+" "+i[g+m-1]+" "+g+" "+m+" "+o[i[g]]);c[b++]=u}else{if(!($=r[a]))throw new Error("Unrecognized CP: "+a);switch($){case"utf8":for(l>=3&&239==i[0]&&187==i[1]&&191==i[2]&&(g=3);g<l;g+=m)m=1,i[g]<128?p=i[g]:i[g]<224?(p=64*(31&i[g])+(63&i[g+1]),m=2):i[g]<240?(p=((15&i[g])<<12)+64*(63&i[g+1])+(63&i[g+2]),m=3):(p=262144*(7&i[g])+((63&i[g+1])<<12)+64*(63&i[g+2])+(63&i[g+3]),m=4),p<65536||(p-=65536,v=55296+(p>>10&1023),p=56320+(1023&p),c[b++]=String.fromCharCode(v)),c[b++]=String.fromCharCode(p);break;case"ascii":if(h&&t.isBuffer(i))return i.toString($);for(g=0;g<l;g++)c[g]=String.fromCharCode(i[g]);b=l;break;case"utf16le":if(l>=2&&255==i[0]&&254==i[1]&&(g=2),h&&t.isBuffer(i))return i.toString($);for(m=2;g+1<l;g+=m)c[b++]=String.fromCharCode((i[g+1]<<8)+i[g]);break;case"utf16be":for(l>=2&&254==i[0]&&255==i[1]&&(g=2),m=2;g+1<l;g+=m)c[b++]=String.fromCharCode((i[g]<<8)+i[g+1]);break;case"utf32le":for(l>=4&&255==i[0]&&254==i[1]&&0===i[2]&&0===i[3]&&(g=4),m=4;g<l;g+=m)p=(i[g+3]<<24)+(i[g+2]<<16)+(i[g+1]<<8)+i[g],p>65535?(p-=65536,c[b++]=String.fromCharCode(55296+(p>>10&1023)),c[b++]=String.fromCharCode(56320+(1023&p))):c[b++]=String.fromCharCode(p);break;case"utf32be":for(l>=4&&255==i[3]&&254==i[2]&&0===i[1]&&0===i[0]&&(g=4),m=4;g<l;g+=m)p=(i[g]<<24)+(i[g+1]<<16)+(i[g+2]<<8)+i[g+3],p>65535?(p-=65536,c[b++]=String.fromCharCode(55296+(p>>10&1023)),c[b++]=String.fromCharCode(56320+(1023&p))):c[b++]=String.fromCharCode(p);break;case"utf7":for(l>=4&&43==i[0]&&47==i[1]&&118==i[2]&&(l>=5&&56==i[3]&&45==i[4]?g=5:56!=i[3]&&57!=i[3]&&43!=i[3]&&47!=i[3]||(g=4));g<l;g+=m)if(43===i[g])if(m=1,45!==i[g+1]){while(String.fromCharCode(i[g+m]).match(/[A-Za-z0-9+\/]/))m++;var E=0;45===i[g+m]&&(++m,E=1);for(var C=[],S="",y=0,k=0,A=0,B=0,T=0,x=0,I=0,R=1;R<m-E;){if(B=_.indexOf(String.fromCharCode(i[g+R++])),T=_.indexOf(String.fromCharCode(i[g+R++])),y=B<<2|T>>4,C.push(y),x=_.indexOf(String.fromCharCode(i[g+R++])),-1===x)break;if(k=(15&T)<<4|x>>2,C.push(k),I=_.indexOf(String.fromCharCode(i[g+R++])),-1===I)break;A=(3&x)<<6|I,I<64&&C.push(A)}for(S=n(1201,C),R=0;R<S.length;++R)c[b++]=S.charAt(R)}else m=2,c[b++]="+";else m=1,c[b++]=String.fromCharCode(i[g]);break;default:throw new Error("Unsupported magic: "+a+" "+r[a])}}return c.slice(0,b).join("")},O=function(t){return!(!e[t]&&!r[t])};return e.utils={decode:R,encode:I,hascp:O,magic:r,cache:A},e}))}).call(this,r("b639").Buffer)},"3e8f":function(e,t){},4362:function(e,t,r){t.nextTick=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),setTimeout((function(){e.apply(null,t)}),0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,n="/";t.cwd=function(){return n},t.chdir=function(t){e||(e=r("df7c")),n=e.resolve(t,n)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"566b":function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return f})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return p}));var n=Object.defineProperty,a=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,l=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c=(e,t)=>{for(var r in t||(t={}))o.call(t,r)&&l(e,r,t[r]);if(s)for(var r of s(t))d.call(t,r)&&l(e,r,t[r]);return e},f=(e,t)=>a(e,i(t)),h=/^((?:background$)|devtools|popup|options|content-script|window)(?:@(\d+)(?:\.(\d+))?)?$/,u=e=>{const[,t,r,n]=e.match(h)||[];return{context:t,tabId:+r,frameId:n?+n:void 0}},p=({context:e,tabId:t,frameId:r})=>["background","popup","options"].includes(e)?e:`${e}@${t}${r?"."+r:""}`},"56b4":function(e,t,r){"use strict";var n=function(){function e(){return{url:"",mediaType:"",base64:!1,attachFromUrl:function(e,t){this.url=e,this.mediaType=t,this.base64=!1},embedFromFile:function(e){var t=r("3e8f"),n=r("df7c");this.mediaType=n.extname(e).toUpperCase().replace(/\./g,"");var a=t.readFileSync(e);this.url=a.toString("base64"),this.base64=!0},embedFromString:function(e,t){this.mediaType=t,this.url=e,this.base64=!0}}}function t(){return{label:"",street:"",city:"",stateProvince:"",postalCode:"",countryRegion:""}}function n(){return{facebook:"",linkedIn:"",twitter:"",flickr:""}}return{uid:"",birthday:"",cellPhone:"",pagerPhone:"",email:"",workEmail:"",firstName:"",formattedName:"",gender:"",homeAddress:t(),homePhone:"",homeFax:"",lastName:"",logo:e(),middleName:"",namePrefix:"",nameSuffix:"",nickname:"",note:"",organization:"",photo:e(),role:"",socialUrls:n(),source:"",title:"",url:"",workUrl:"",workAddress:t(),workPhone:"",workFax:"",version:"3.0",getMajorVersion:function(){var e=this.version?this.version.split(".")[0]:"4";return isNaN(e)?4:parseInt(e)},getFormattedString:function(){var e=r("7be9");return e.getFormattedString(this)},saveToFile:function(e){var t=r("7be9"),n=t.getFormattedString(this),a=r("3e8f");a.writeFileSync(e,n,{encoding:"utf8"})}}};e.exports=n},"5c9b":function(e,t,r){"use strict";r.r(t);var n=r("0fb6"),a=r("d3f4"),i=r("75f8"),s=(r("566b"),Object(a["a"])("window")),o=Object(i["a"])("window",e=>s.postMessage(e));function d(e){s.setNamespace(e),s.enable()}s.onMessage(e=>{"type"in e&&"transactionID"in e?o.endTransaction(e.transactionID):o.handleMessage(e)});var l,{sendMessage:c,onMessage:f}=o,{openStream:h,onOpenStreamChannel:u}=Object(i["b"])(o),p=r("61d5");function g(e){return void 0===e?null:Object.assign(v(e),{kind:e.kind,isGroup:e.isGroup,contact:e["contact"]?m(e["contact"]):null,groupMetadata:e["groupMetadata"]?v(e["groupMetadata"]):null,presence:e["presence"]?v(e["presence"]):null,msgs:null})}function m(e){return void 0===e?null:Object.assign(v(e),{formattedName:e.formattedName,displayName:e.displayName,isHighLevelVerified:e.isHighLevelVerified,isMe:e.isMe,isMyContact:e.isMyContact,isPSA:(()=>{try{return e.isPSA}catch(t){return!1}})(),isUser:e.isUser,isVerified:e.isVerified,isWAContact:(()=>{try{return e.isWAContact}catch(t){return!1}})(),profilePicThumbObj:e.profilePicThumb?b(e.profilePicThumb):{},statusMute:e.statusMute,msgs:null})}function b(e){return void 0===e?null:Object.assign({},v({eurl:e.eurl,id:e.id,img:e.img,imgFull:e.imgFull,raw:e.raw,tag:e.tag}))}function v(e){if(e){let t={};e=e.toJSON?e.toJSON():{...e};for(let r in e)"id"!==r?"object"!==typeof e[r]||Array.isArray(e[r])?t[r]=e[r]:t[r]=v(e[r]):t[r]={...e[r]};return t}return{}}async function w(){return new Promise(async(e,t)=>{const r=await BULK_WPP.chat.list(),n=r.map(e=>g(e));e(n)})}async function $(e){return new Promise(async(e,t)=>{const r=await BULK_WPP.chat.list(),n=r.filter(e=>{var t;return(null===e||void 0===e||null===(t=e.contact)||void 0===t?void 0:t.isGroup)&&"community"!==e.kind}).map(e=>{let{participants:t}=e.groupMetadata;return t=t.map(e=>e.contact).filter(e=>!e.isMe).map(e=>m(e)),Object.assign(g(e),{participants:t})});e(n)})}let E=!1,C=!0,S="",y=setInterval((async function(){try{let e=await BULK_WPP.labels.getAllLabels(),t=await w(),r=await $();const n=await BULK_WPP.chat.list();window.postMessage({chatNum:n.length,module:"wapi sender"},"*"),t.length&&r.length&&e&&(setTimeout(async()=>{await D(),await F()},3e3),clearInterval(y))}catch(e){}}),500);function k(){c(p["q"],{waExporterDownload:!0,exportGroupSuccess:!0,module:"wapi sender"},"content-script")}async function A(e){const t=await BULK_WPP.chat.list(),r=t.map(e=>e.id._serialized||e.id);return void 0!==e&&e(r),r}async function _(e,t){let r=await T(),a=[],i="";if(r){let s=B(e,r,a,i);i=s.name,a=s.participantsInfoList,a=Object(n["b"])(a),await V(a,i,t)}else c(p["p"],{waExporterDownload:!0,chooseWarning:!1,module:"wapi sender"},"content-script")}function B(e,t,r,n){if("radioChatAll"===e){n="All Chats";for(let e=0;e<t.length;e++){let n={},a=t[e]["contact"];n["phoneNum"]=a["id"]["user"]?a["id"]["user"]:"",n["isMyContact"]=!0===a["isMyContact"]?"True":"False",n["displayName"]=a["pushname"]?a["pushname"]:"",n["savedName"]=a["name"]?a["name"]:"",r.push(n)}}if("radioChatUnsaved"===e){n="Unsaved Chats";for(let e=0;e<t.length;e++){let n={},a=t[e]["contact"];!0!==a["isMyContact"]&&(n["phoneNum"]=a["id"]["user"]?a["id"]["user"]:"",n["isMyContact"]="False",n["displayName"]=a["pushname"]?a["pushname"]:"",n["savedName"]=a["name"]?a["name"]:"",r.push(n))}}return{name:n,participantsInfoList:r}}async function T(){let e=await BULK_WPP.chat.list(),t=[];for(let r=0;r<e.length;r++){let n=e[r]["contact"]["isUser"];n&&t.push(e[r])}return t}async function x(e,t,r){let a=await P(t);if(a){let t=[],b=[];for(let e=0;e<a.length;e++){let v=a[e],w=[],$=[],E=v["contact"]["name"],C=v["groupMetadata"]["participants"]["_models"];for(let e in C){var i,s,o;if(C[e]["isAdmin"])if(null!==(i=C[e])&&void 0!==i&&null!==(i=i.contact)&&void 0!==i&&null!==(i=i.phoneNumber)&&void 0!==i&&i.user)$.push(null===(s=C[e])||void 0===s||null===(s=s.contact)||void 0===s||null===(s=s.phoneNumber)||void 0===s?void 0:s.user);else $.push(null===(o=C[e])||void 0===o||null===(o=o.contact)||void 0===o||null===(o=o.id)||void 0===o?void 0:o.user)}if(r){let e=v["groupMetadata"]["participants"]["_models"];for(let t=0;t<e.length;t++){var d;let r={},n=!0;var l,c,f;if(null!==(d=e[t])&&void 0!==d&&null!==(d=d.contact)&&void 0!==d&&null!==(d=d.phoneNumber)&&void 0!==d&&d.user)r["phoneNum"]=null===(l=e[t])||void 0===l||null===(l=l.contact)||void 0===l||null===(l=l.phoneNumber)||void 0===l?void 0:l.user;else r["phoneNum"]=null!==(c=e[t])&&void 0!==c&&null!==(c=c.contact)&&void 0!==c&&null!==(c=c.id)&&void 0!==c&&c.user?null===(f=e[t])||void 0===f||null===(f=f.contact)||void 0===f||null===(f=f.id)||void 0===f?void 0:f.user:"";r["isMyContact"]=!0===e[t]["contact"]["isMyContact"]?"True":"False",r["displayName"]=e[t]["contact"]["pushname"]?e[t]["contact"]["pushname"]:"",r["savedName"]=e[t]["contact"]["name"]?e[t]["contact"]["name"]:"";for(let e=0;e<$.length;e++)if(r["phoneNum"]===$[e]){n=!1;break}n&&w.push(r)}}if(!r){let e=[],t=v["groupMetadata"]["participants"]["_models"];for(let r=0;r<t.length;r++){var h;let n={};var u,p,g;if(null!==(h=t[r])&&void 0!==h&&null!==(h=h.contact)&&void 0!==h&&null!==(h=h.phoneNumber)&&void 0!==h&&h.user)n["phoneNum"]=null===(u=t[r])||void 0===u||null===(u=u.contact)||void 0===u||null===(u=u.phoneNumber)||void 0===u?void 0:u.user;else n["phoneNum"]=null!==(p=t[r])&&void 0!==p&&null!==(p=p.contact)&&void 0!==p&&null!==(p=p.id)&&void 0!==p&&p.user?null===(g=t[r])||void 0===g||null===(g=g.contact)||void 0===g||null===(g=g.id)||void 0===g?void 0:g.user:"";n["isMyContact"]=!0===t[r]["contact"]["isMyContact"]?"True":"False",n["displayName"]=t[r]["contact"]["pushname"]?t[r]["contact"]["pushname"]:"",n["savedName"]=t[r]["contact"]["name"]?t[r]["contact"]["name"]:"",e.push(n["phoneNum"]),w.push(n)}for(let r=0;r<$.length;r++)if(-1===e.indexOf($[r])){let e=void 0;try{e=await BULK_WPP.contact.get($[r]+"@c.us")}catch(m){}let t={};e&&(t["phoneNum"]=$[r],t["isMyContact"]=!0===e["__x_isMyContact"]?"True":"False",t["displayName"]=e["__x_pushname"]?e["__x_pushname"]:"",t["savedName"]=e["__x_name"]?e["__x_name"]:"",w.push(t))}}w=Object(n["b"])(w),t.push(w),b.push(E)}await R(t,b,r,e)}}async function I(e,t){let r=await U(),a=t&&r[t.value]||[],i=await window.BULK_WPP.labels.getAllLabels();const s=i.reduce((e,t)=>(e[t.id]=t.name,e),{});if(t&&a.length>0&&s){let r=s[t.value],i=[];for(let e=0;e<a.length;e++){let t=void 0;if(a[e]["contact"]["isUser"])try{t=await BULK_WPP.contact.get(a[e]["id"]["user"]+"@c.us")}catch(u){}var o,d,l,c,f,h;if(t)i.push({phoneNum:(null===(o=a[e])||void 0===o||null===(o=o.id)||void 0===o?void 0:o.user)||"",isMyContact:!0===(null===(d=t)||void 0===d?void 0:d.__x_isMyContact)?"True":"False",displayName:null!==(l=t)&&void 0!==l&&l.__x_pushname?null===(c=t)||void 0===c?void 0:c.__x_pushname:"",savedName:null!==(f=t)&&void 0!==f&&f.__x_name?null===(h=t)||void 0===h?void 0:h.__x_name:""})}await R([Object(n["b"])(i)],[r],null,e,"Label Name","All Labels")}else await R([],[],null,e,"Label Name","All Labels")}async function R(e,t,r,n,a="Group Name",i="All Groups"){if("vcf"===n){let n=[],a=[];for(let t=0;t<e.length;t++)if(e[t])for(let r=0;r<e[t].length;r++)n.push(e[t][r]["phoneNum"]),a.push(e[t][r]["savedName"]);let s=t.length>0?t[0]:i;r&&(s+=" Exclude Admins"),O(n,a,s)}else{let s=z.utils.book_new(),o=[];for(let r=0;r<e.length;r++){let n=e[r];t[r]=t[r].replace(/\*|\?|:|\\|\/|\[|\]/gm,"_");for(let e=0;e<n.length;e++){let i={};i["Country Code"]=n[e]["countryCode"],i["Country"]=n[e]["country"],i["Contact's Public Display Name"]=n[e]["displayName"],i["Phone Number"]=n[e]["phoneNum"],i["is My Contact"]=n[e]["isMyContact"],i["Saved Name"]=n[e]["savedName"],i[a]=t[r],o.push(i)}}let d=z.utils.json_to_sheet(o);switch(d["!cols"]=[{wch:15},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:30}],z.utils.book_append_sheet(s,d,"sheet1"),!0){case 1===t.length&&!r:z.writeFile(s,t[0]+"."+n);break;case 1===t.length&&r:z.writeFile(s,t[0]+" Exclude Admins."+n);break;case!r:z.writeFile(s,i+"."+n);break;case r:z.writeFile(s,i+" Exclude Admins."+n);break}}}function O(e,t,n="All Groups"){let a="",i=[],s=[];for(let r=0;r<e.length;r++)-1===i.indexOf(e[r])&&(i.push(e[r]),s.push(t[r]));for(let f=0;f<i.length;f++){let e=W();e.lastName=s[f],e.workPhone=i[f];var o=r("7be9");a+=o.getFormattedString(e)}const d="text/x-vcard",l=".vcf",c=new Blob([a],{type:d});H(c,n+l)}async function P(e){var t;const r=await(null===(t=window.BULK_WPP)||void 0===t?void 0:t.chat.list()),n=r.filter(e=>{var t;return null===e||void 0===e||null===(t=e.contact)||void 0===t?void 0:t.isGroup});let a=[];for(let i=0;i<n.length;i++){let t=n[i]["id"]["user"];e===t&&a.push(n[i])}return a}async function N(e){let t=[],r=await BULK_WPP.group.getParticipants(e["id"]["user"]+"@g.us");for(let d=0;d<r.length;d++){var n,a;let e={};if(null===(n=r[d])||void 0===n||null===(n=n.contact)||void 0===n||!n.isMe){var i,s,o;if(null!==(a=r[d])&&void 0!==a&&null!==(a=a.contact)&&void 0!==a&&null!==(a=a.phoneNumber)&&void 0!==a&&a.user)e["phoneNum"]=null===(i=r[d])||void 0===i||null===(i=i.contact)||void 0===i||null===(i=i.phoneNumber)||void 0===i?void 0:i.user;else e["phoneNum"]=null!==(s=r[d])&&void 0!==s&&null!==(s=s.contact)&&void 0!==s&&null!==(s=s.id)&&void 0!==s&&s.user?null===(o=r[d])||void 0===o||null===(o=o.contact)||void 0===o||null===(o=o.id)||void 0===o?void 0:o.user:"";t.push(e["phoneNum"])}}return t}async function D(){try{const e=await $(),t=await Promise.all(e.map(async e=>{var t,r,n;const a=await N(e);return{data:a,value:null===e||void 0===e||null===(t=e.id)||void 0===t?void 0:t.user,label:null===e||void 0===e||null===(r=e.contact)||void 0===r?void 0:r.name,key:null===e||void 0===e||null===(n=e.id)||void 0===n?void 0:n.user}}));return c(p["t"],{sendGroupsInfos:t,module:"wapi sender"},"content-script"),t}catch(e){return console.error("操作失败:",e),[]}}async function F(){try{let e=await window.BULK_WPP.labels.getAllLabels(),t=e.map(e=>({value:e.id,label:e.name,count:e.count}));console.log("发送数据到content-label"),console.log(t),c(p["u"],{sendLabelsInfos:t,module:"wapi sender"},"content-script"),c(p["s"],{isBusiness:window.BULK_WPP.profile.isBusiness(),module:"wapi sender"},"content-script");let r=await U();for(let n in r){let e=[];r[n].forEach(t=>{let r={};r.id=t.id,e.push(r)}),r[n]=e}c(p["v"],{sendLabelsMeta:r,module:"wapi sender"},"content-script")}catch(e){console.log("getAndSendAllLabels",e)}}async function M(e,t){let r=0;t>=e&&(r=1e3*Math.floor(Math.random()*(t-e+1)+e));while(r>0)r-=1e3,window.postMessage({waitSeconds:r/1e3,module:"wapi sender"},"*"),await new Promise(e=>setTimeout(e,1e3))}function L(e,t,r){if(t==[])return e;if(r<t.length)try{t=t[r];let n=t["whatsAppNumber"]?t["whatsAppNumber"]:"",a=t["firstName"]?t["firstName"]:"",i=t["lastName"]?t["lastName"]:"",s=t["other"]?t["other"]:"";e=e.replaceAll("{{WhatsApp Number}}",n),e=e.replaceAll("{{First Name}}",a),e=e.replaceAll("{{Last Name}}",i),e=e.replaceAll("{{Other}}",s)}catch(n){console.log(n)}return e}async function U(){await window.BULK_WPP.labels.getAllLabels();const e=await BULK_WPP.chat.list(),t=e.filter(e=>e.labels.length>0);let r={};for(let n=0;n<t.length;n++){let e=g(t[n]);for(let a=0;a<t[n].labels.length;a++){let i=t[n].labels[a];i in r?r[i].push(e):r[i]=[e]}}return r}d(p["a"]),f(p["h"],async({data:e})=>{let t=await BULK_WPP.chat.list();for(let r=0;r<t.length;r++)if(t[r].__x_active){S=t[r].__x_id._serialized;break}}),f("CONTENT_TO_INJECT_GET_LABELS",async()=>{console.log("收到消息"),await D(),await F()}),f(p["i"],async({data:e})=>{S&&S!==e.mediaDetail.contactno&&(e.mediaDetail.contactno=S),window.BULK_WPP.chat.sendFileMessage(e.mediaDetail.contactno,e.mediaDetail.file)}),f(p["g"],async({data:e})=>{S&&S!==e.buttonDetail.contactno&&(e.buttonDetail.contactno=S),window.BULK_WPP.chat.sendTextMessage(e.buttonDetail.contactno,e.buttonDetail.content,{useTemplateButtons:!0,buttons:e.buttonDetail.button})}),window.addEventListener("message",(async function(e){if("wapi sender"===e.data.module){if(void 0!==e.data.deleteMessage){try{const t=await BULK_WPP.chat.list(),r=t.find(t=>t.id._serialized===e.data.phone);BULK_WPP.chat.delete(r.id)}catch(t){}return}if(e.data.audioDetail&&(S&&S!==e.data.audioDetail.contactno&&(e.data.audioDetail.contactno=S),window.BULK_WPP.chat.sendFileMessage(e.data.audioDetail.contactno,e.data.audioDetail.file,{type:"audio",isPtt:!0})),e.data.transCard){let{contactNum:t,myNumber:r}=e.data.transCard,n=await BULK_WPP.contact.get(r+"@c.us");await BULK_WPP.chat.sendVCardContactMessage(t+"@c.us",{id:r+"@c.us",name:n.name||n.formattedName})}if(void 0!==e.data.echoDeleteMessage)return void window.BULK_WPP.chat.getMessages(e.data.phone).then(t=>{window.postMessage({key:e.data.key,value:!1,module:"eventDB"},"*")}).catch(t=>{window.postMessage({key:e.data.key,value:!0,module:"eventDB"},"*")});void 0!==e.data.uninstallFlag&&(C=!0),async function(){let t=e.data.phoneNumList,r=e.data.content,n=e.data.minNum,a=e.data.maxNum;E=e.data.stopFlag;let i=e.data.excelData,s=(e.data.sendButtonValue,e.data.buttonInputValue,e.data.button_radio,A()),o=[],d=[];if(t){window.postMessage({countAll:t.length,module:"wapi sender"},"*");for(let e=0;e<t.length;e++){if(E)break;{let l=0;console.log("发送开始");let c=t[e];for(let t=0;t<s.length;t++){let n=s[t];if(0===n.indexOf(c+"@")){let t=L(r,i,e);BULK_WPP.chat.sendTextMessage(n,t,{createChat:!0}),l=1;break}}l?(l=0,o.push(c),window.postMessage({countSuccess:o.length,module:"wapi sender"},"*")):(d.push(c),window.postMessage({countFail:d.length,module:"wapi sender"},"*")),e!==t.length-1&&await M(n,a)}}E||window.postMessage({stopFlag:!0,module:"wapi sender"},"*")}let l=e.data.waExporterDownload?e.data.exportGroup:"",f=e.data.waExporterDownload?e.data.exportType:"",h=e.data.waExporterDownload?e.data.exportFrom:null,u=e.data.valueGroup?e.data.valueGroup:[],g=e.data.valueLabel?e.data.valueLabel:null,m=!!e.data.excludeAdminValue&&e.data.excludeAdminValue;"chat"===h?(await _(l,f),k()):"label"===h?(await I(f,g),window.postMessage({waExporterDownload:!0,exportLabelSuccess:!0,module:"wapi sender"},"*"),c(p["r"],{waExporterDownload:!0,exportLabelSuccess:!0,module:"wapi sender"},"content-script")):"group"===h&&(await x(f,u,m),k())}()}}),!1);let H=r("21a6"),z=r("1146"),W=r("56b4");async function V(e,t,r){let n=[],a=[],i=[];t=t.replace(/\*|\?|:|\\|\/|\[|\]/gm,"_");for(let s=0;s<e.length;s++){let r={};r["Country Code"]=e[s]["countryCode"],r["Country"]=e[s]["country"],r["Contact's Public Display Name"]=e[s]["displayName"],r["Phone Number"]=e[s]["phoneNum"],r["is My Contact"]=e[s]["isMyContact"],r["Saved Name"]=e[s]["savedName"],r["Group Name"]=t,n.push(r),a.push(r["Phone Number"]),i.push(r["Saved Name"])}if("vcf"===r)O(a,i,t);else{const e=z.utils.json_to_sheet(n);e["!cols"]=[{wch:15},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:30}];const a=z.utils.book_new();z.utils.book_append_sheet(a,e,"sheet1"),z.writeFile(a,t+"."+r)}c(p["p"],{waExporterDownload:!0,chooseWarning:!1,module:"wapi sender"},"content-script")}function G(e){null!==e&&void 0!==e&&e.id&&e.isNewMsg&&queueMicrotask(()=>{"ciphertext"===e.type&&e.once("change:type",()=>{queueMicrotask(()=>{X(e,e.collection)})}),X(e,e.collection)})}function X(e,t){e.id.fromMe?j(e,t):K(e,t)}async function j(){}async function K(e){var t;const r=null===e||void 0===e||null===(t=e.senderObj)||void 0===t||null===(t=t.id)||void 0===t?void 0:t._serialized;c("I2C_RECEIVE_NEW_MESSAGE",{sender_user:r},"content-script")}function Y(e,...t){switch(e){case"add":G(...t);break}}null===(l=window.BULK_WPP)||void 0===l||null===(l=l.webpack)||void 0===l||l.onFullReady(()=>{var e;null===(e=window)||void 0===e||null===(e=e.BULK_WPP)||void 0===e||null===(e=e.whatsapp)||void 0===e||null===(e=e.MsgStore)||void 0===e||e.on("all",Y)}),f("C2I_SEND_AUTO_REPLY_MESSAGE",({data:e})=>{const{sender_user:t,replyContent:r}=e;window.BULK_WPP.chat.sendTextMessage(t,r,{})}),f("C2I_CHECK_NUMBER_STATUS",async({data:e})=>{var t;const{phoneNum:r}=e||{};let n=null;try{n=await window.BULK_WPP.contact.queryExists(r+"@c.us")}catch(a){console.error("检测出错了",a)}return!(null===(t=n)||void 0===t||!t.wid)})},"61d5":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"B",(function(){return a})),r.d(t,"A",(function(){return i})),r.d(t,"q",(function(){return s})),r.d(t,"r",(function(){return o})),r.d(t,"p",(function(){return d})),r.d(t,"t",(function(){return l})),r.d(t,"u",(function(){return c})),r.d(t,"v",(function(){return f})),r.d(t,"s",(function(){return h})),r.d(t,"f",(function(){return u})),r.d(t,"e",(function(){return p})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return m})),r.d(t,"z",(function(){return b})),r.d(t,"h",(function(){return v})),r.d(t,"i",(function(){return w})),r.d(t,"g",(function(){return $})),r.d(t,"l",(function(){return E})),r.d(t,"m",(function(){return C})),r.d(t,"k",(function(){return S})),r.d(t,"n",(function(){return y})),r.d(t,"j",(function(){return k})),r.d(t,"y",(function(){return A})),r.d(t,"x",(function(){return _})),r.d(t,"w",(function(){return B})),r.d(t,"o",(function(){return T})),r.d(t,"b",(function(){return x}));const n="com.whatsapp.web.zf.BulkSender",a="pop=>content:transaction_id",i="pop=>content:buttonMessage",s="inject=>content:exportGroupSuccess",o="inject=>content:exportLabelSuccess",d="inject=>content:chooseWarning",l="inject=>content:sendGroupsInfos",c="inject=>content:sendLabelsInfos",f="inject=>content:sendLabelsMeta",h="inject=>content:isBusiness",u="content=>background:zbaseType",p="content=>background:userPhoneNum",g="content=>background:installLogFlag",m="content=>background:setIPConfig",b="pop=>background:url",v="content=>inject:currentChat",w="content=>inject:mediaDetail",$="content=>inject:buttonDetail",E="content=>pop:isShowNoActive",C="content=>pop:isShowNoSubscription",S="content=>pop:isOneNoSubscription",y="content=>pop:showSaveTimeDialog",k="content=>pop:getProPermission",A="POP_TO_BACKGROUND_GET_PERMISSION",_="POP_TO_BACKGROUND_GET_CUSTOMERSERVICE",B="pay/pricing_pro_plan.html",T="assets/WAPlusSenderTemplate1.xlsx",x="https://wazapsenderextension.vercel.app/sender/bulk_sender/completedCommentGuide.json"},"75f8":function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f}));var n=r("566b"),a=r("1323"),i=r.n(a),s=r("8c9f");let o=()=>({events:{},emit(e,...t){(this.events[e]||[]).forEach(e=>e(...t))},on(e,t){return(this.events[e]=this.events[e]||[]).push(t),()=>this.events[e]=(this.events[e]||[]).filter(e=>e!==t)}});var d=(e,t,r)=>{const a=i()(),o=new Map,d=new Map,l=i=>{if(i.destination.context===e&&!i.destination.frameId&&!i.destination.tabId){null==r||r(i);const{transactionId:t,messageID:a,messageType:c}=i,f=()=>{const e=o.get(t);if(e){const{err:r,data:n}=i;if(r){const t=r,n=self[t.name],a=new("function"===typeof n?n:Error)(t.message);for(const e in t)a[e]=t[e];e.reject(a)}else e.resolve(n);o.delete(t)}},h=async()=>{let t,r,o=!1;try{const c=d.get(a);if("function"!==typeof c)throw o=!0,new Error(`[webext-bridge] No handler registered in '${e}' to accept messages with id '${a}'`);t=await c({sender:i.origin,id:a,data:i.data,timestamp:i.timestamp})}catch(c){r=c}finally{if(r&&(i.err=Object(s["a"])(r)),l(Object(n["a"])(Object(n["b"])({},i),{messageType:"reply",data:t,origin:{context:e,tabId:null},destination:i.origin,hops:[]})),r&&!o)throw t}};switch(c){case"reply":return f();case"message":return h()}}return i.hops.push(`${e}::${a}`),t(i)};return{handleMessage:l,endTransaction:e=>{const t=o.get(e);null==t||t.reject("Transaction was ended before it could complete"),o.delete(e)},sendMessage:(t,r,a="background")=>{const s="string"===typeof a?Object(n["d"])(a):a,d="Bridge#sendMessage ->";if(!s.context)throw new TypeError(d+" Destination must be any one of known destinations");return new Promise((n,a)=>{const d={messageID:t,data:r,destination:s,messageType:"message",transactionId:i()(),origin:{context:e,tabId:null},hops:[],timestamp:Date.now()};o.set(d.transactionId,{resolve:n,reject:a});try{l(d)}catch(c){o.delete(d.transactionId),a(c)}})},onMessage:(e,t)=>(d.set(e,t),()=>d.delete(e))}},l=class{constructor(e,t){this.endpointRuntime=e,this.streamInfo=t,this.emitter=o(),this.isClosed=!1,this.handleStreamClose=()=>{this.isClosed||(this.isClosed=!0,this.emitter.emit("closed",!0),this.emitter.events={})},l.initDone||(e.onMessage("__crx_bridge_stream_transfer__",e=>{const{streamId:t,streamTransfer:r,action:n}=e.data,a=l.openStreams.get(t);a&&!a.isClosed&&("transfer"===n&&a.emitter.emit("message",r),"close"===n&&(l.openStreams.delete(t),a.handleStreamClose()))}),l.initDone=!0),l.openStreams.set(this.streamInfo.streamId,this)}get info(){return this.streamInfo}send(e){if(this.isClosed)throw new Error("Attempting to send a message over closed stream. Use stream.onClose(<callback>) to keep an eye on stream status");this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:e,action:"transfer"},this.streamInfo.endpoint)}close(e){e&&this.send(e),this.handleStreamClose(),this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:null,action:"close"},this.streamInfo.endpoint)}onMessage(e){return this.getDisposable("message",e)}onClose(e){return this.getDisposable("closed",e)}getDisposable(e,t){const r=this.emitter.on(e,t);return Object.assign(r,{dispose:r,close:r})}},c=l;c.initDone=!1,c.openStreams=new Map;var f=e=>{const t=new Map,r=new Map,a=o();async function s(r,a){if(t.has(r))throw new Error("webext-bridge: A Stream is already open at this channel");const s="string"===typeof a?Object(n["d"])(a):a,o={streamId:i()(),channel:r,endpoint:s},d=new c(e,o);return d.onClose(()=>t.delete(r)),await e.sendMessage("__crx_bridge_stream_open__",o,s),t.set(r,d),d}function d(e,t){if(r.has(e))throw new Error("webext-bridge: This channel has already been claimed. Stream allows only one-on-one communication");r.set(e,t),a.emit("did-change-stream-callbacks")}return e.onMessage("__crx_bridge_stream_open__",t=>new Promise(i=>{const{sender:s,data:o}=t,{channel:d}=o;let l=!1,f=()=>{};const h=()=>{const t=r.get(d);"function"===typeof t?(t(new c(e,Object(n["a"])(Object(n["b"])({},o),{endpoint:s}))),l&&f(),i(!0)):l||(l=!0,f=a.on("did-change-stream-callbacks",h))};h()})),{openStream:s,onOpenStreamChannel:d}}},"7be9":function(e,t,r){"use strict";(function(){var t="3";function r(e){return e?("string"!==typeof e&&(e=""+e),e.replace(/\n/g,"\\n").replace(/,/g,"\\,").replace(/;/g,"\\;")):""}function n(){return"\r\n"}function a(e,a,i,s){var o;o=t>=4?s?";ENCODING=b;MEDIATYPE=image/":";MEDIATYPE=image/":3===t?s?";ENCODING=b;TYPE=":";TYPE=":s?";ENCODING=BASE64;":";";var d=e+o+i+":"+r(a)+n();return d}function i(e,a){var i="";return(a.details.label||a.details.street||a.details.city||a.details.stateProvince||a.details.postalCode||a.details.countryRegion)&&(t>=4?i="ADR"+e+";TYPE="+a.type+(a.details.label?';LABEL="'+r(a.details.label)+'"':"")+":;;"+r(a.details.street)+";"+r(a.details.city)+";"+r(a.details.stateProvince)+";"+r(a.details.postalCode)+";"+r(a.details.countryRegion)+n():(a.details.label&&(i="LABEL"+e+";TYPE="+a.type+":"+r(a.details.label)+n()),i+="ADR"+e+";TYPE="+a.type+":;;"+r(a.details.street)+";"+r(a.details.city)+";"+r(a.details.stateProvince)+";"+r(a.details.postalCode)+";"+r(a.details.countryRegion)+n())),i}function s(e){return e.getFullYear()+("0"+(e.getMonth()+1)).slice(-2)+("0"+e.getDate()).slice(-2)}e.exports={getFormattedString:function(e){t=e.getMajorVersion();var o="";o+="BEGIN:VCARD"+n(),o+="VERSION:"+e.version+n();var d=t>=4?"":";CHARSET=UTF-8",l=e.formattedName;if(l||(l="",[e.firstName,e.middleName,e.lastName].forEach((function(e){e&&l&&(l+=" "),l+=e}))),o+="FN"+d+":"+r(l)+n(),o+="N"+d+":"+r(e.lastName)+";"+r(e.firstName)+";"+r(e.middleName)+";"+r(e.namePrefix)+";"+r(e.nameSuffix)+n(),e.nickname&&t>=3&&(o+="NICKNAME"+d+":"+r(e.nickname)+n()),e.gender&&(o+="GENDER:"+r(e.gender)+n()),e.uid&&(o+="UID"+d+":"+r(e.uid)+n()),e.birthday&&(o+="BDAY:"+s(e.birthday)+n()),e.anniversary&&(o+="ANNIVERSARY:"+s(e.anniversary)+n()),e.email&&(Array.isArray(e.email)||(e.email=[e.email]),e.email.forEach((function(e){o+=t>=4?"EMAIL"+d+";type=HOME:"+r(e)+n():t>=3&&t<4?"EMAIL"+d+";type=HOME,INTERNET:"+r(e)+n():"EMAIL"+d+";HOME;INTERNET:"+r(e)+n()}))),e.workEmail&&(Array.isArray(e.workEmail)||(e.workEmail=[e.workEmail]),e.workEmail.forEach((function(e){o+=t>=4?"EMAIL"+d+";type=WORK:"+r(e)+n():t>=3&&t<4?"EMAIL"+d+";type=WORK,INTERNET:"+r(e)+n():"EMAIL"+d+";WORK;INTERNET:"+r(e)+n()}))),e.otherEmail&&(Array.isArray(e.otherEmail)||(e.otherEmail=[e.otherEmail]),e.otherEmail.forEach((function(e){o+=t>=4?"EMAIL"+d+";type=OTHER:"+r(e)+n():t>=3&&t<4?"EMAIL"+d+";type=OTHER,INTERNET:"+r(e)+n():"EMAIL"+d+";OTHER;INTERNET:"+r(e)+n()}))),e.logo.url&&(o+=a("LOGO",e.logo.url,e.logo.mediaType,e.logo.base64)),e.photo.url&&(o+=a("PHOTO",e.photo.url,e.photo.mediaType,e.photo.base64)),e.cellPhone&&(Array.isArray(e.cellPhone)||(e.cellPhone=[e.cellPhone]),e.cellPhone.forEach((function(e){o+=t>=4?'TEL;VALUE=uri;TYPE="voice,cell":tel:'+r(e)+n():"TEL;TYPE=CELL:"+r(e)+n()}))),e.pagerPhone&&(Array.isArray(e.pagerPhone)||(e.pagerPhone=[e.pagerPhone]),e.pagerPhone.forEach((function(e){o+=t>=4?'TEL;VALUE=uri;TYPE="pager,cell":tel:'+r(e)+n():"TEL;TYPE=PAGER:"+r(e)+n()}))),e.homePhone&&(Array.isArray(e.homePhone)||(e.homePhone=[e.homePhone]),e.homePhone.forEach((function(e){o+=t>=4?'TEL;VALUE=uri;TYPE="voice,home":tel:'+r(e)+n():"TEL;TYPE=HOME,VOICE:"+r(e)+n()}))),e.workPhone&&(Array.isArray(e.workPhone)||(e.workPhone=[e.workPhone]),e.workPhone.forEach((function(e){o+=t>=4?'TEL;VALUE=uri;TYPE="voice,work":tel:'+r(e)+n():"TEL;TYPE=WORK,VOICE:"+r(e)+n()}))),e.homeFax&&(Array.isArray(e.homeFax)||(e.homeFax=[e.homeFax]),e.homeFax.forEach((function(e){o+=t>=4?'TEL;VALUE=uri;TYPE="fax,home":tel:'+r(e)+n():"TEL;TYPE=HOME,FAX:"+r(e)+n()}))),e.workFax&&(Array.isArray(e.workFax)||(e.workFax=[e.workFax]),e.workFax.forEach((function(e){o+=t>=4?'TEL;VALUE=uri;TYPE="fax,work":tel:'+r(e)+n():"TEL;TYPE=WORK,FAX:"+r(e)+n()}))),e.otherPhone&&(Array.isArray(e.otherPhone)||(e.otherPhone=[e.otherPhone]),e.otherPhone.forEach((function(e){o+=t>=4?'TEL;VALUE=uri;TYPE="voice,other":tel:'+r(e)+n():"TEL;TYPE=OTHER:"+r(e)+n()}))),[{details:e.homeAddress,type:"HOME"},{details:e.workAddress,type:"WORK"}].forEach((function(e){o+=i(d,e)})),e.title&&(o+="TITLE"+d+":"+r(e.title)+n()),e.role&&(o+="ROLE"+d+":"+r(e.role)+n()),e.organization&&(o+="ORG"+d+":"+r(e.organization)+n()),e.url&&(o+="URL"+d+":"+r(e.url)+n()),e.workUrl&&(o+="URL;type=WORK"+d+":"+r(e.workUrl)+n()),e.note&&(o+="NOTE"+d+":"+r(e.note)+n()),e.socialUrls)for(var c in e.socialUrls)e.socialUrls.hasOwnProperty(c)&&e.socialUrls[c]&&(o+="X-SOCIALPROFILE"+d+";TYPE="+c+":"+r(e.socialUrls[c])+n());return e.source&&(o+="SOURCE"+d+":"+r(e.source)+n()),o+="REV:"+(new Date).toISOString()+n(),e.isOrganization&&(o+="X-ABShowAs:COMPANY"+n()),o+="END:VCARD"+n(),o}}})()},"8c9f":function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return o}));Error;const n=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],a=Symbol(".toJSON was called"),i=e=>{e[a]=!0;const t=e.toJSON();return delete e[a],t},s=({from:t,seen:r,to_:o,forceEnumerable:d,maxDepth:l,depth:c})=>{const f=o||(Array.isArray(t)?[]:{});if(r.push(t),c>=l)return f;if("function"===typeof t.toJSON&&!0!==t[a])return i(t);for(const[n,a]of Object.entries(t))"function"===typeof e&&e.isBuffer(a)?f[n]="[object Buffer]":null===a||"object"!==typeof a||"function"!==typeof a.pipe?"function"!==typeof a&&(a&&"object"===typeof a?r.includes(t[n])?f[n]="[Circular]":(c++,f[n]=s({from:t[n],seen:[...r],forceEnumerable:d,maxDepth:l,depth:c})):f[n]=a):f[n]="[object Stream]";for(const{property:e,enumerable:a}of n)"string"===typeof t[e]&&Object.defineProperty(f,e,{value:t[e],enumerable:!!d||a,configurable:!0,writable:!0});return f};function o(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY}=t;return"object"===typeof e&&null!==e?s({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0}):"function"===typeof e?`[Function: ${e.name||"anonymous"}]`:e}}).call(this,r("b639").Buffer)},9152:function(e,t){